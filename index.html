<html lang="ar" dir="ltr">
<head>
  <meta charset="UTF-8">
  <title>تقرير كراج الميكانيكي</title>
  <style>
    body {
      font-family: 'Cairo', Arial, sans-serif;
      background: #121212 url('https://github.com/mohamedelsawaf9193/garage-report/raw/main/mechan.png') center center fixed;
      background-size: cover;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #f1f1f1;
      margin: 0;
    }

    .container {
      background: rgba(30, 30, 30, 0.95);
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.4);
      max-width: 500px;
      width: 90%;
    }

    h1 {
      color: #f5c542;
      text-align: center;
      margin-bottom: 20px;
      font-size: 1.8rem;
    }

    .section-block {
      background: #1e1e1e;
      margin-bottom: 15px;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #333;
    }

    label {
      font-weight: bold;
      margin-top: 8px;
      display: block;
      text-align: left;
      color: #f1f1f1;
    }

    input, select {
      width: 100%;
      padding: 8px;
      margin: 6px 0 10px 0;
      border-radius: 6px;
      border: 1px solid #555;
      background: #2a2a2a;
      color: #fff;
    }

    button {
      width: 100%;
      padding: 10px;
      background: #f5c542;
      color: #000;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      margin-top: 5px;
      transition: background 0.3s;
    }

    button:hover {
      background: #e0b633;
    }

    .export {
      margin-top: 15px;
    }

    pre {
      background: #1b1b1b;
      color: #ddd;
      padding: 10px;
      border-radius: 6px;
      white-space: pre-wrap;
    }

    .unit-row {
      display: flex;
      gap: 5px;
      margin-bottom: 5px;
    }

    .unit-prefix, .unit-code {
      flex: 1;
      padding: 6px;
      border-radius: 6px;
      border: 1px solid #555;
      background: #2a2a2a;
      color: #fff;
    }

    .remove-btn {
      background: #e63946;
      border: none;
      border-radius: 6px;
      color: white;
      padding: 5px 10px;
      cursor: pointer;
    }

    .remove-btn:hover {
      background: #b71c1c;
    }

    .add-unit-btn {
      background: #43aa8b;
      margin-top: 8px;
    }

    .add-unit-btn:hover {
      background: #218c5b;
    }

    .group-title {
      font-weight: bold;
      color: #f5c542;
      margin-bottom: 5px;
      text-align: left;
    }

    .fleet-count {
      font-size: 1.1em;
      font-weight: bold;
      color: #f5c542;
      margin-bottom: 7px;
    }

    .disabled-input {
      background: #444;
      color: #999;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>تقرير كراج الميكانيكي</h1>
    <form id="reportForm" onsubmit="return false;">
      <div class="section-block">
        <label>رقم التقرير:</label>
        <input type="text" id="reportNumber" class="report-input" placeholder="مثال: 5" oninput="updatePreview()">
      </div>
      <div class="section-block">
        <label>من الساعة:</label>
        <input type="text" id="fromTime" class="time-input" placeholder="01:00" maxlength="5" oninput="updatePreview()">
        <select id="fromTimeAmPm" class="ampm-select" onchange="updatePreview()">
          <option value="م">م</option>
          <option value="ص">ص</option>
        </select>
        <label>حتى الساعة:</label>
        <input type="text" id="toTime" class="time-input" placeholder="02:00" maxlength="5" oninput="updatePreview()">
        <select id="toTimeAmPm" class="ampm-select" onchange="updatePreview()">
          <option value="م">م</option>
          <option value="ص">ص</option>
        </select>
      </div>
      <!-- الوحدات -->
      <div class="section-block">
        <div class="group-title">قيادة الكراج:</div>
        <div id="garageLead" class="units-list"></div>
        <button type="button" class="add-unit-btn" onclick="addUnit('garageLead')">إضافة وحدة</button>
      </div>
      <button type="button" onclick="exportReport()">تحديث التقرير</button>
      <button type="button" onclick="copyReport()">نسخ التقرير</button>
    </form>
    <div class="export">
      <h2 style="color:#f5c542;">نموذج التقرير:</h2>
      <pre id="reportPreview"></pre>
    </div>
  </div>

  <script>
    function copyReport() {
      const reportText = document.getElementById('reportPreview').textContent;
      navigator.clipboard.writeText(reportText).then(() => {
        alert("تم نسخ التقرير بنجاح ✅");
      }).catch(err => {
        alert("حدث خطأ أثناء النسخ ❌");
        console.error(err);
      });
    }

    function addUnit(areaId) {
      const parent = document.getElementById(areaId);
      const unitDiv = document.createElement('div');
      unitDiv.className = "unit-row";
      const prefixSelect = document.createElement('select');
      prefixSelect.className = 'unit-prefix';
      [
        {v: 'G', t: 'G'},
        {v: 'H', t: 'H'},
        {v: 'E', t: 'E'},
        {v: 'P', t: 'P'},
        {v: 'A', t: 'A'},
        {v: 'F', t: 'F'},
        {v: 'M', t: 'M'},
        {v: 'R', t: 'R'},
      ].forEach(optObj=>{
        const opt = document.createElement('option');
        opt.value = optObj.v;
        opt.textContent = optObj.t;
        prefixSelect.appendChild(opt);
      });
      const codeInput = document.createElement('input');
      codeInput.type = 'text';
      codeInput.placeholder = 'رقم الوحدة (مثال: 012)';
      codeInput.className = 'unit-code';
      codeInput.oninput = updatePreview;

      const removeBtn = document.createElement('button');
      removeBtn.type = 'button';
      removeBtn.className = 'remove-btn';
      removeBtn.textContent = '×';
      removeBtn.onclick = () => { parent.removeChild(unitDiv); updatePreview(); };

      unitDiv.appendChild(prefixSelect);
      unitDiv.appendChild(codeInput);
      unitDiv.appendChild(removeBtn);
      parent.appendChild(unitDiv);

      updatePreview();
    }

    function getUnits(areaId) {
      const parent = document.getElementById(areaId);
      const units = [];
      parent.querySelectorAll('.unit-row').forEach(unitRow => {
        const prefix = unitRow.querySelector('.unit-prefix').value;
        const code = unitRow.querySelector('.unit-code').value.trim();
        if(prefix && code) {
          units.push(`@${prefix}-${code}`);
        }
      });
      return units;
    }

    function generateLine(label, arr, emptyLabel) {
      let out = `${label} `;
      out += arr.length ? arr.join('\n') : (emptyLabel || "لايوجد");
      out += '\n\n';
      return out;
    }

    function generateReport() {
      const reportNumber = document.getElementById('reportNumber').value.trim();
      const fromTime = document.getElementById('fromTime').value.trim();
      const fromTimeAmPm = document.getElementById('fromTimeAmPm').value;
      const toTime = document.getElementById('toTime').value.trim();
      const toTimeAmPm = document.getElementById('toTimeAmPm').value;
      let report = `تم استلام التقرير الميداني لكراج الميكانيكي\n\n`;
      report += `تقرير رقم ( ${reportNumber} )\n\n`;
      report += `من الساعه ${fromTime} (${fromTimeAmPm})\nحتى الساعه ${toTime} (${toTimeAmPm})\n\n`;
      report += generateLine("قيادة الكراج:", getUnits('garageLead'));
      return report;
    }

    function updatePreview() {
      document.getElementById('reportPreview').textContent = generateReport();
    }

    function exportReport() {
      document.getElementById('reportPreview').textContent = generateReport();
    }

    addUnit('garageLead');
    updatePreview();
  </script>
</body>
</html>
